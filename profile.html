<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ambar - Profile</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* Desktop Background Particles */
        .bg-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            display: block;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
        }

        .particle:nth-child(1) { width: 4px; height: 4px; left: 15%; animation-delay: 0s; }
        .particle:nth-child(2) { width: 3px; height: 3px; left: 25%; animation-delay: 2s; }
        .particle:nth-child(3) { width: 5px; height: 5px; left: 65%; animation-delay: 4s; }
        .particle:nth-child(4) { width: 3px; height: 3px; left: 85%; animation-delay: 6s; }
        .particle:nth-child(5) { width: 4px; height: 4px; left: 45%; animation-delay: 1s; }

        @keyframes float {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10%, 90% { opacity: 1; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 0.8; }
        }

        /* Top Header */
        .top-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 100;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .logo {
            font-family: 'Dancing Script', cursive;
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(45deg, #ff6b9d, #c44569, #f8b500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 1px;
        }

        .currency-bar {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .currency-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.08);
            padding: 10px 16px;
            border-radius: 30px;
            color: white;
            font-weight: 600;
            font-size: 14px;
            border: 1px solid rgba(255, 255, 255, 0.12);
            transition: all 0.3s ease;
        }

        .currency-item:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .currency-icon {
            font-size: 16px;
        }

        .coins { color: #ffd700; }
        .stars { color: #ff6b9d; }
        .hearts { color: #e74c3c; }

        /* Profile Content */
        .profile-container {
            position: absolute;
            top: 80px;
            left: 0;
            right: 0;
            bottom: 120px;
            padding: 20px;
            overflow-y: auto;
            z-index: 10;
        }

        .profile-content {
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* ID Cards */
        .id-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 25px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
        }

        .id-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6b9d, #c44569, #f8b500);
        }

        .user-card::before {
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .partner-card::before {
            background: linear-gradient(90deg, #ff6b9d, #c44569);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .character-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 3px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            position: relative;
        }

        .character-layers {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transform: scale(0.8);
            transform-origin: center;
        }

        .avatar-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .avatar-layer img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .card-title {
            flex: 1;
        }

        .name {
            font-size: 24px;
            font-weight: 700;
            color: white;
            margin-bottom: 5px;
        }

        .relationship-status {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
        }

        .user-status { color: #667eea; }
        .partner-status { color: #ff6b9d; }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: white;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Game Scores */
        .game-scores {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .score-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .score-value {
            font-size: 16px;
            font-weight: 600;
            color: white;
            margin-bottom: 3px;
        }

        .score-label {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
        }

        .luck { color: #ffd700; }
        .level { color: #4CAF50; }
        .knowledge { color: #2196F3; }

        /* AI Analysis */
        .ai-analysis {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .analysis-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .analysis-title {
            font-size: 16px;
            font-weight: 600;
            color: #ff6b9d;
        }

        .compatibility-score {
            margin-left: auto;
            background: linear-gradient(45deg, #ff6b9d, #c44569);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        .analysis-text {
            font-size: 14px;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.8);
        }

        /* Action Button */
        .action-button {
            width: 100%;
            padding: 20px;
            background: linear-gradient(45deg, #ff6b9d, #c44569);
            border: none;
            border-radius: 25px;
            color: white;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .action-button:hover {
            background: linear-gradient(45deg, #e55a87, #b03a5a);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 107, 157, 0.4);
        }

        .add-partner {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        .add-partner:hover {
            background: linear-gradient(45deg, #5a6fd8, #6a4190);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 120px;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 20px;
            z-index: 100;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
        }

        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 12px 20px;
            border-radius: 20px;
            min-width: 80px;
            position: relative;
        }

        .nav-btn:hover,
        .nav-btn.active {
            color: white;
            background: rgba(255, 255, 255, 0.08);
        }

        .nav-btn.active {
            color: #ff6b9d;
        }

        .nav-btn i {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .nav-btn span {
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-btn.active::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: #ff6b9d;
            border-radius: 50%;
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            .bg-particles { display: none; }
            
            .top-header {
                padding: 0 20px;
                height: 70px;
            }

            .logo { font-size: 28px; }

            .currency-bar { gap: 2px; }
            
            .currency-item {
                padding: 6px 12px;
                font-size: 12px;
            }

            .profile-container {
                top: 70px;
                bottom: 90px;
                padding: 15px;
            }

            .id-card { padding: 20px; }

            .character-avatar {
                width: 60px;
                height: 60px;
            }

            .name { font-size: 20px; }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .game-scores {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }

            .bottom-nav {
                height: 90px;
                padding: 15px 10px;
            }

            .nav-btn {
                padding: 8px 2px;
                min-width: 60px;
            }

            .nav-btn i { font-size: 20px; }
            .nav-btn span { font-size: 10px; }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .id-card:nth-child(1) { animation-delay: 0.1s; }
        .id-card:nth-child(2) { animation-delay: 0.3s; }
    </style>
</head>
<body>
    <!-- Background Particles -->
    <div class="bg-particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <!-- Top Header -->
    <div class="top-header">
        <div class="logo">Ambar</div>
        <div class="currency-bar">
            <div class="currency-item">
                <i class="fas fa-coins currency-icon coins"></i>
                <span>1,250</span>
            </div>
            <div class="currency-item">
                <i class="fas fa-star currency-icon stars"></i>
                <span>15</span>
            </div>
            <div class="currency-item">
                <i class="fas fa-heart currency-icon hearts"></i>
                <span>420</span>
            </div>
        </div>
    </div>

    <!-- Profile Content -->
    <div class="profile-container">
        <div class="profile-content">
            <!-- User ID Card -->
            <div class="id-card user-card">
                <div class="card-header">
                    <div class="character-avatar" id="userAvatar">
                        <div class="character-layers">
                            <!-- User's cropped character image will be generated here -->
                        </div>
                    </div>
                    <div class="card-title">
                        <div class="name">Aarav Sharma</div>
                        <div class="relationship-status user-status">You</div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">420</div>
                        <div class="stat-label">Hearts Received</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">15</div>
                        <div class="stat-label">Current Streak</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">1,250</div>
                        <div class="stat-label">Total Coins</div>
                    </div>
                </div>

                <div class="game-scores">
                    <div class="score-item">
                        <div class="score-value luck">78%</div>
                        <div class="score-label">Luck</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value level">Level 12</div>
                        <div class="score-label">Progress</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value knowledge">845</div>
                        <div class="score-label">Knowledge</div>
                    </div>
                </div>
            </div>

            <!-- Partner ID Card -->
            <div class="id-card partner-card">
                <div class="card-header">
                    <div class="character-avatar" id="partnerAvatar">
                        <div class="character-layers">
                            <!-- Partner's cropped character image will be generated here -->
                        </div>
                    </div>
                    <div class="card-title">
                        <div class="name">Priya Patel</div>
                        <div class="relationship-status partner-status">Your Partner</div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">385</div>
                        <div class="stat-label">Hearts Received</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">13</div>
                        <div class="stat-label">Current Streak</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">890</div>
                        <div class="stat-label">Total Coins</div>
                    </div>
                </div>

                <div class="game-scores">
                    <div class="score-item">
                        <div class="score-value luck">82%</div>
                        <div class="score-label">Luck</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value level">Level 11</div>
                        <div class="score-label">Progress</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value knowledge">792</div>
                        <div class="score-label">Knowledge</div>
                    </div>
                </div>

                <div class="ai-analysis">
                    <div class="analysis-header">
                        <i class="fas fa-robot" style="color: #ff6b9d;"></i>
                        <span class="analysis-title">AI Analysis</span>
                        <span class="compatibility-score">87% Compatible</span>
                    </div>
                    <div class="analysis-text">
                        Your gaming styles complement each other perfectly! Aarav's strategic approach balances Priya's intuitive gameplay. Both show consistent dedication with strong streaks. The knowledge gap suggests room for mutual learning and growth in your relationship.
                    </div>
                </div>
            </div>

            <!-- Action Button -->
            <button class="action-button" onclick="endRelationship()">
                <i class="fas fa-heart-broken"></i>
                End Relationship
            </button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-btn" onclick="navigateTo('home')">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </button>
        <button class="nav-btn" onclick="navigateTo('games')">
            <i class="fas fa-gamepad"></i>
            <span>Games</span>
        </button>
        <button class="nav-btn" onclick="navigateTo('store')">
            <i class="fas fa-store"></i>
            <span>Store</span>
        </button>
        <button class="nav-btn active" onclick="navigateTo('profile')">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </button>
    </div>

    <script>
        // Configuration for cropping character avatars
    const CROP_CONFIG = {
        boy: {
            fronthair: { x: 198, y: 512, w: 484, h: 484 },
            eyeball: { x: 198, y: 512, w: 484, h: 484 },
            eyebrow: { x: 198, y: 512, w: 484, h: 484 },
            mouth: { x: 198, y: 512, w: 484, h: 484 },
            skin: { x: 198, y: 512, w: 484, h: 484 },
            bottom: { x: 198, y: 512, w: 484, h: 484 },
            shoes: { x: 198, y: 512, w: 484, h: 484 },
            top: { x: 198, y: 512, w: 484, h: 484 },
            backhair: { x: 198, y: 512, w: 484, h: 484 }
        },
        girl: {
            fronthair: { x: 470, y: 623, w: 466, h: 474 },
            eyeball: { x: 470, y: 623, w: 466, h: 474 },
            eyebrow: { x: 470, y: 623, w: 466, h: 474 },
            mouth: { x: 470, y: 623, w: 466, h: 474 },
            skin: { x: 470, y: 623, w: 466, h: 474 },
            bottom: { x: 470, y: 623, w: 466, h: 474 },
            shoes: { x: 470, y: 623, w: 466, h: 474 },
            top: { x: 470, y: 623, w: 466, h: 474 },
            backhair: { x: 470, y: 623, w: 466, h: 474 }
        }
    };

        // User and partner data (in real app, this would come from backend)
        const userData = {
            name: "Aarav Sharma",
            gender: "boy",
            character: {
                fronthair: 1,
                eyeball: 1,
                eyebrow: 1,
                mouth: 1,
                skin: 1,
                bottom: 1,
                shoes: 1,
                top: 1,
                backhair: 1
            },
            stats: {
                heartsReceived: 420,
                currentStreak: 15,
                totalCoins: 1250
            },
            gameScores: {
                luck: 78,
                level: 12,
                knowledge: 845
            }
        };

        const partnerData = {
            name: "Priya Patel",
            gender: "girl",
            character: { 
                fronthair: 1,
                eyeball: 1,
                eyebrow: 1,
                mouth: 1,
                skin: 1,
                bottom: 1,
                shoes: 1,
                top: 1,
                backhair: 1
            },
            stats: {
                heartsReceived: 385,
                currentStreak: 13,
                totalCoins: 890
            },
            gameScores: {
                luck: 82,
                level: 11,
                knowledge: 792
            }
        };

        function generateCharacterAvatar(containerId, characterData, gender) {
            const container = document.getElementById(containerId).querySelector('.character-layers');
            container.innerHTML = '';

            // Create layers for the avatar using backhair crop configuration
            const layers = [ 'eyeball', 'eyebrow', 'mouth', 'backhair', 'skin', 'bottom', 'shoes', 'top', 'fronthair' ];
  
            layers.forEach(layer => {
                if (characterData[layer]) {
                    const canvas = document.createElement('canvas');
                    canvas.width = 80;
                    canvas.height = 80;
                    canvas.className = 'avatar-layer';
                    container.appendChild(canvas);
                    
                    cropCharacterPart(canvas, gender, layer, characterData[layer]);
                }
            });
        }

        function cropCharacterPart(canvas, gender, layer, id) {
            const ctx = canvas.getContext('2d');
            const img = new Image();
            img.crossOrigin = 'anonymous';
            
            img.onload = () => {
                // Use backhair crop config for consistent avatar framing
                const crop = CROP_CONFIG[gender][layer] || CROP_CONFIG[gender].backhair;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Draw the cropped character part
                ctx.drawImage(
                    img,
                    crop.x, crop.y, crop.w, crop.h,
                    0, 0, canvas.width, canvas.height
                );
            };
            
            img.onerror = () => {
                // Fallback to GitHub avatar style if image fails
                createGitHubStyleAvatar(ctx, gender === 'boy' ? '#4285f4' : '#ea4335');
            };
            
            img.src = `https://raw.githubusercontent.com/xchirxg/db/main/${gender}/${layer}/${id}.png`;
        }

        function createGitHubStyleAvatar(ctx, color) {
            // Create a simple geometric avatar as fallback
            ctx.fillStyle = color;
            ctx.fillRect(0, 0, 80, 80);
            
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.beginPath();
            ctx.arc(40, 30, 15, 0, 2 * Math.PI);
            ctx.fill();
            
            ctx.beginPath();
            ctx.arc(40, 65, 25, 0, Math.PI);
            ctx.fill();
        }

    function navigateTo(screen) {
        // remove active class
        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        event.target.closest('.nav-btn').classList.add('active');

        if (screen === 'home') {
            window.location.href = 'home.html';
        } else if (screen === 'games') {
            window.location.href = 'game.html';
        } else if (screen === 'store') {
            window.location.href = 'store2.html';
        } else if (screen === 'profile') {
            window.location.href = 'profile.html';
        }
    }

        function endRelationship() {
            if (confirm('Are you sure you want to end this relationship? This action cannot be undone.')) {
                console.log('Ending relationship and navigating to partner search');
                // In real app, this would call backend API and then navigate
                alert('Relationship ended. Redirecting to partner search...');
            }
        }

        function addPartner() {
            console.log('Navigating to partner search screen');
            // This function would be used when there's no current partner
        }

        // Initialize the profile screen
        document.addEventListener('DOMContentLoaded', function() {
            // Generate character avatars
            generateCharacterAvatar('userAvatar', userData.character, userData.gender);
            generateCharacterAvatar('partnerAvatar', partnerData.character, partnerData.gender);
            
            // Animate currency items
            const currencyItems = document.querySelectorAll('.currency-item');
            currencyItems.forEach((item, index) => {
                item.style.opacity = '0';
                item.style.transform = 'translateY(-10px)';
                
                setTimeout(() => {
                    item.style.transition = 'all 0.4s ease';
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, index * 150);
            });
        });

        // Function to show "Add Partner" state when no partner exists
        function showAddPartnerState() {
            const partnerCard = document.querySelector('.partner-card');
            partnerCard.innerHTML = `
                <div style="text-align: center; padding: 40px 20px;">
                    <i class="fas fa-user-plus" style="font-size: 48px; color: rgba(255, 255, 255, 0.3); margin-bottom: 20px;"></i>
                    <div style="color: rgba(255, 255, 255, 0.7); font-size: 16px; margin-bottom: 10px;">No Partner Yet</div>
                    <div style="color: rgba(255, 255, 255, 0.5); font-size: 14px;">Find someone special to start your journey</div>
                </div>
            `;
            
            const actionButton = document.querySelector('.action-button');
            actionButton.innerHTML = '<i class="fas fa-plus"></i> Find Partner';
            actionButton.className = 'action-button add-partner';
            actionButton.onclick = addPartner;
        }
    </script>
</body>
</html>